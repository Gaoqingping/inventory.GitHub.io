(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-code1"],{2568:function(e,t,n){"use strict";var r=n("7562"),i=n.n(r);i.a},"278d":function(e,t,n){"use strict";n.r(t);var r=n("7a2a"),i=n("f2f8");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("2568");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"583e9fb9",null,!1,r["a"],a);t["default"]=c.exports},"6b18":function(e,t,n){"use strict";var r=n("4ea4");n("99af"),n("c975"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(n("e019"));var i=n("d805"),o={props:{},data:function(){return{vedio:"",canvas:"",context:"",stopScan:null,errorMes:"",result:""}},mounted:function(){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(e){console.log(e);var t=(0,i.getQrUrl)(e.tempFiles.path);t.then((function(e){e.data?(console.log(e.data,"二维码内容"),console.log(e.data)):console.log("识别二维码失败, 请重新上传")})).catch((function(e){console.log(111,JSON.stringify(e))}))}}),console.log(1);var e=this;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,this.vedio=document.getElementById("qr-vedio"),this.context=uni.createCanvasContext("qr-canvas",this),console.log(2),navigator.mediaDevices.enumerateDevices().then(a).catch(s),console.log(3);var t=[];navigator.mediaDevices.enumerateDevices().then((function(n){for(var r=0;r!=n.length;++r){var i=n[r];"videoinput"===i.kind&&-1!=i.label.indexOf("back")&&t.push(i.deviceId)}var o=function(t){e.vedio.src=window.URL&&window.URL.createObjectURL(t)||t,window.localMediaStream=t,e.vedio.addEventListener("loadstart",(function(){e.vedio.play()}),!1),e.stopScan=setInterval(e.scan,500)};navigator.webkitGetUserMedia({video:{optional:[{sourceId:t[0]}]}},o,(function(e){console.log(e)}))})),qrcode.callback=function(t){e.result=t,console.log(t),window.localMediaStream&&window.localMediaStream.stop&&window.localMediaStream.stop(),e.stopScan&&clearInterval(e.stopScan)}},methods:{scan:function(){window.localMediaStream&&this.context.drawImage(this.vedio,0,0,100,100);try{qrcode.decode()}catch(e){console.log("decode has error")}}}};function a(e){console.log(e)}function s(e){console.log("Error: ",e)}t.default=o},"6c57":function(e,t,n){var r=n("23e7"),i=n("da84");r({global:!0},{globalThis:i})},7562:function(e,t,n){var r=n("78cd");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("1abb7815",r,!0,{sourceMap:!1,shadowMode:!1})},"78cd":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".v[data-v-583e9fb9]{width:320px;height:240px}#qr-canvas[data-v-583e9fb9]{width:800px;height:800px}",""]),e.exports=t},"7a2a":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-uni-input",{attrs:{type:"file",value:"请"}}),n("v-uni-video",{staticClass:"v",attrs:{id:"qr-vedio",autoplay:""}}),n("v-uni-canvas",{staticStyle:{width:"800px",height:"600px",display:"none"},attrs:{id:"qr-canvas",width:"800",height:"600"}}),n("p",{directives:[{name:"show",rawName:"v-show",value:""!=e.result,expression:"result != ''"}]},[e._v(e._s(e.result))]),n("p",{directives:[{name:"show",rawName:"v-show",value:""!=e.errorMes,expression:"errorMes != ''"}]},[e._v(e._s(e.errorMes))])],1)},o=[]},d805:function(e,t){},e019:function(e,t,n){n("a4d3"),n("e01a"),n("d28b"),n("4de4"),n("6c57"),n("d3b7"),n("3ca3"),n("ddb0"),function(e,r){r(t,n("55f0"))}(0,(function(e,t){"use strict";function n(e){return e&&"object"===typeof e&&"default"in e?e:{default:e}}var r=n(t),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
    Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function o(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(t){o(t)}}function s(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var s=function(){function e(){this.timerCapture=null,this.canvasElem=null,this.gCtx=null,this.stream=null,this.videoElem=null,this.getUserMediaHandler=null,this.videoConstraints={video:!0,audio:!1},this.defaultOption={inversionAttempts:"attemptBoth"}}return e.prototype.isCanvasSupported=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},e.prototype._createImageData=function(e,t,n){this.canvasElem||this._prepareCanvas(t,n),this.gCtx.clearRect(0,0,t,n),this.gCtx.drawImage(e,0,0,t,n);var r=this.gCtx.getImageData(0,0,this.canvasElem.width,this.canvasElem.height);return r},e.prototype._prepareCanvas=function(e,t){this.canvasElem||(this.canvasElem=document.createElement("canvas"),this.canvasElem.style.width=e+"px",this.canvasElem.style.height=t+"px",this.canvasElem.width=e,this.canvasElem.height=t),this.gCtx=this.canvasElem.getContext("2d")},e.prototype._captureToCanvas=function(e,t){return o(this,void 0,void 0,(function(){var n,i,s=this;return a(this,(function(c){switch(c.label){case 0:return this.timerCapture&&clearTimeout(this.timerCapture),n=function(){var n=new Promise((function(n){return o(s,void 0,void 0,(function(){var i,s,c=this;return a(this,(function(u){return e.videoWidth&&e.videoHeight?(s=this._createImageData(e,e.videoWidth,e.videoHeight),i=r["default"](s.data,s.width,s.height,t),i?n(i):this.timerCapture=setTimeout((function(){return o(c,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this._captureToCanvas(e,t)];case 1:return i=r.sent(),n(i),[2]}}))}))}),500)):this.timerCapture=setTimeout((function(){return o(c,void 0,void 0,(function(){return a(this,(function(r){switch(r.label){case 0:return[4,this._captureToCanvas(e,t)];case 1:return i=r.sent(),n(i),[2]}}))}))}),500),[2]}))}))}));return n},[4,n()];case 1:return i=c.sent(),[2,i]}}))}))},e.prototype.decodeFromCamera=function(e,t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){var n,r,o,s;return a(this,(function(a){switch(a.label){case 0:if(n=i(i({},this.defaultOption),t),this.stop(),!navigator.mediaDevices.getUserMedia)throw new Error("Couldn't get video from camera");a.label=1;case 1:return a.trys.push([1,4,,5]),[4,navigator.mediaDevices.getUserMedia(this.videoConstraints)];case 2:return r=a.sent(),e.srcObject=r,this.videoElem=e,this.stream=r,[4,this.decodeFromVideo(e,n)];case 3:return o=a.sent(),[2,o];case 4:throw s=a.sent(),s;case 5:return[2]}}))}))},e.prototype.decodeFromVideo=function(e,t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){var n,r,o;return a(this,(function(a){switch(a.label){case 0:n=i(i({},this.defaultOption),t),a.label=1;case 1:return a.trys.push([1,3,,4]),this.videoElem=e,[4,this._captureToCanvas(e,n)];case 2:return r=a.sent(),[2,r];case 3:throw o=a.sent(),o;case 4:return[2]}}))}))},e.prototype.decodeFromImage=function(e,t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){var n,r,o,s;return a(this,(function(a){switch(a.label){case 0:if(n=null,r=i(i({},this.defaultOption),t),!(+e.nodeType>0))return[3,1];if(!e.src)throw new Error("The ImageElement must contain a src");return n=e,[3,3];case 1:return"string"!==typeof e?[3,3]:(n=document.createElement("img"),n.src=e,t.crossOrigin&&(n.crossOrigin=t.crossOrigin),o=function(){return new Promise((function(e){n.onload=function(){return e(!0)}}))},[4,o()]);case 2:a.sent(),a.label=3;case 3:return s=null,n&&(s=this._decodeFromImageElm(n,r)),[2,s]}}))}))},e.prototype._decodeFromImageElm=function(e,t){void 0===t&&(t={});var n=i(i({},this.defaultOption),t),o=this._createImageData(e,e.width,e.height),a=r["default"](o.data,o.width,o.height,n);return a||!1},e.prototype.stop=function(){if(this.stream){var e=this.stream.getTracks()[0];e.stop(),this.stream=null,this.videoElem.srcObject=null}return this.timerCapture&&(clearTimeout(this.timerCapture),this.timerCapture=null),this},e.prototype.setGroupId=function(e){return this.videoConstraints.video=!e||{advanced:[{groupId:e}]},this},e.prototype.getVideoDevices=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return navigator.mediaDevices.enumerateDevices?[4,navigator.mediaDevices.enumerateDevices()]:[3,2];case 1:return e=t.sent(),[2,e.filter((function(e){return"videoinput"===e.kind}))];case 2:throw new Error("Current browser doest not support MediaStreamTrack.getSources")}}))}))},e}();e.default=s,Object.defineProperty(e,"__esModule",{value:!0})}))},f2f8:function(e,t,n){"use strict";n.r(t);var r=n("6b18"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a}}]);